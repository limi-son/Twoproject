"use strict";$(function(){var n=$.cookie("uid");if(null==n){$(".center").html('<section class="cent-con">\n                <section class="cen-right">\n                    <h2>您的购物车还是空的！</h2>\n                    <p>登录后将显示您之前加入的商品</p>\n                    <input type="button" value="立即登陆"  id="log">\n                    <input type="button" value="马上去购物" id="idex">\n                </section>\n            </section>'),$(".center").on("click","#idex",function(){location.href="../index.html?"}),$(".center").on("click","#log",function(){location.href="login.html?"})}else{var p="";$.ajax({type:"post",url:"../api/cart.php",data:{uid:n},success:function(n){var e=JSON.parse(n);if(0!=e.arr.length){p=' <section class="c2">\n                        <section class="car-con">\n                            <ul class="nav-top">\n                                <li id="allchecked"><input type="checkbox" name="" id="">全选</li>\n                                <li>商品名称</li>\n                                <li>单价</li>\n                                <li>数量</li>\n                                <li>小计</li>\n                                <li>操作</li>\n                        </ul>';for(var t=0;t<e.arr.length;t++)p+='<section class="sopp" data-id="'+e.arr[t].id+'">\n                                    <section class="good_check"><input type="checkbox" name="" id=""></section>\n                                    <section><img src="../images/'+e.arr[t].images+'" width="80px" alt=""></section>\n                                    <section>'+e.arr[t].name+'</section>\n                                    <section class="price">￥'+e.arr[t].price+'</section>\n                                    <section class="zong"><input type="button" value="-" class="cutnum"><input type="text" class="val" value="'+e.arr[t].num+'"><input type="button" value="+" class="addnum"></section>\n                                    <section class="good_total">￥ '+e.arr[t].sum+"</section>\n                                    <section><span class='good_del'>x</span></section>\n                                </section>";p+='<section class="pr">\n                            <section id="allnum">已选择<span>0</span>件</section>\n                            <input type="button" value="去结算">\n                            <section id="totalprice">合计：<strong>0</strong>&nbsp;元</section>\n                        </section>\n                    </section>\n                </section>'}else p='<section class="cent-con">\n                        <section class="cen-right">\n                            <h2>您的购物车还是空的！</h2>\n                            <input type="button" value="马上去购物" id="idex">\n                        </section>\n                    </section>';function c(n){var e=1*n.parent().parent().find($(".price")).text().substring(1),t=1*n.parent().parent().find($(".zong")).find($(".val")).val(),c=parseInt(n.parent().parent().attr("data-id")),i=e*t;n.parent().next().html("￥&nbsp;"+i),a(),$.ajax({type:"post",url:"../api/cart1.php",data:{id:c,num:t,sum:i},success:function(n){JSON.parse(n)}})}$(".center").html(p),$(".center").on("click","#idex",function(){location.href="../index.html?"}),$(".center").on("click",".addnum",function(){var n=$(this).prev().val();100<=++n&&(n=100),$(this).prev().val(n),c($(this))}),$(".center").on("click",".cutnum",function(){var n=$(this).next().val();--n<=1&&(n=1),$(this).next().val(n),c($(this))});var i=0,o=0;$(".center").on("click",".good_del",function(){i=parseInt($(this).parent().parent().attr("data-id")),o=$(this);$("#box").append('<section class="Mask">\n                            <section class="register">\n                                <h2>确定要删除吗</h2>\n                                <section class="que">\n                                    <input type="button" value="不同意" class="disa">\n                                    <input type="button" value="同意" class="Agree">\n                                </section>\n                            </section>\n                        </section>')}),$("#box").on("click",".Mask .disa",function(){$("#box .Mask").css("display","none")}),$("#box").on("click",".Mask .Agree",function(){$("#box .Mask").css("display","none"),o.parent().parent().remove(),a(),$.ajax({type:"post",url:"../api/cart2.php",data:{id:i},success:function(n){}}),function(){if(0==$(".addnum").size()){$(".center").html('<section class="cent-con">\n                                    <section class="cen-right">\n                                        <h2>您的购物车还是空的！</h2>\n                                        <input type="button" value="马上去购物" id="idex">\n                                    </section>\n                                </section>')}}()}),$(".center").on("click",".sopp .good_check input",function(){a()});var s=[];function a(){s=[];for(var n=0;n<$(".center .sopp .good_check input").size();n++)$(".center .sopp .good_check input").eq(n).prop("checked")&&s.push(n);s.length==$(".center .sopp .good_check input").size()?$(".center .c2 .car-con .nav-top #allchecked input").prop("checked","checked"):$(".center .c2 .car-con .nav-top #allchecked input").removeAttr("checked");var e=0,t=0;for(n=0;n<s.length;n++)t+=1*$(".val").eq(s[n]).val(),e+=1*$(".good_total").eq(s[n]).text().substring(2);$("#allnum").html("已选择<span>"+t+"</span>件"),$("#totalprice").html("合计：<strong>"+e+"&nbsp;</strong>元")}$(".center .c2 .car-con .nav-top #allchecked input").prop("checked","checked"),$(".center .c2 .car-con .nav-top #allchecked input").prop("checked")?$(".center .sopp .good_check input").prop("checked","checked"):$(".center .sopp .good_check input").removeAttr("checked"),a(),$(".center .c2 .car-con .nav-top #allchecked input").on("click",function(){$(this).prop("checked")?$(".center .sopp .good_check input").prop("checked","checked"):$(".center .sopp .good_check input").removeAttr("checked"),a()}),$(".center").on("change",".val",function(){c($(this)),a()})}})}});